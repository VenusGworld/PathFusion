2023-06-01 20:13:49.470871: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-01 20:13:49.755085: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2023-06-01 20:13:49.755179: I tensorflow/compiler/xla/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
2023-06-01 20:13:51.732593: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-06-01 20:13:51.732746: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-06-01 20:13:51.732781: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
2023-06-01 20:13:54.648562: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-01 20:13:54.753626: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudnn.so.8'; dlerror: libcudnn.so.8: cannot open shared object file: No such file or directory
1000
98851 42
fuck (48172, 48172)
Sinkhorn time= 1656.9604451656342
		total is  48172
		hits@1 is 0.13482936145478702
		hits@5 is 0.23189819812339119
		hits@10 is 0.28122145644772895
		MR is 1365.7750244140625
		MRR is 0.18615856766700745
[[    0  3068]
 [    0  3296]
 [    0  3310]
 ...
 [98850 51423]
 [98850 52019]
 [98850 54276]]
[[    0     9]
 [    1     9]
 [    2     9]
 ...
 [98848    81]
 [98849    81]
 [98850    81]]
[1. 1. 1. ... 1. 1. 1.]
Tensor("lambda_2/Mean_2:0", shape=(), dtype=float32)
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_3 (InputLayer)           [(None, None)]       0           []                               
                                                                                                  
 input_5 (InputLayer)           [(None, None, 2)]    0           []                               
                                                                                                  
 token_embedding (TokenEmbeddin  (98851, 128)        12652928    ['input_3[0][0]']                
 g)                                                                                               
                                                                                                  
 token_embedding_1 (TokenEmbedd  (84, 128)           10752       ['input_3[0][0]']                
 ing)                                                                                             
                                                                                                  
 input_4 (InputLayer)           [(None, None, 2)]    0           []                               
                                                                                                  
 lambda (Lambda)                (98851, 128)         0           ['input_5[0][0]',                
                                                                  'token_embedding[0][0]']        
                                                                                                  
 input_1 (InputLayer)           [(None, None, 2)]    0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, None, 2)]    0           []                               
                                                                                                  
 lambda_1 (Lambda)              (98851, 128)         0           ['input_4[0][0]',                
                                                                  'token_embedding_1[0][0]']      
                                                                                                  
 nr__graph_attention (NR_GraphA  (98851, 384)        172672      ['lambda[0][0]',                 
 ttention)                                                        'token_embedding_1[0][0]',      
                                                                  'input_1[0][0]',                
                                                                  'input_2[0][0]',                
                                                                  'input_3[0][0]']                
                                                                                                  
 nr__graph_attention_1 (NR_Grap  (98851, 384)        172672      ['lambda_1[0][0]',               
 hAttention)                                                      'token_embedding_1[0][0]',      
                                                                  'input_1[0][0]',                
                                                                  'input_2[0][0]',                
                                                                  'input_3[0][0]']                
                                                                                                  
 concatenate (Concatenate)      (98851, 768)         0           ['nr__graph_attention[0][0]',    
                                                                  'nr__graph_attention_1[0][0]']  
                                                                                                  
 input_6 (InputLayer)           [(None, None, 2)]    0           []                               
                                                                                                  
 dropout (Dropout)              (98851, 768)         0           ['concatenate[0][0]']            
                                                                                                  
 lambda_2 (Lambda)              ()                   0           ['input_6[0][0]',                
                                                                  'dropout[0][0]']                
                                                                                                  
==================================================================================================
Total params: 13,009,024
Trainable params: 13,009,024
Non-trainable params: 0
__________________________________________________________________________________________________
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:17<05:31, 17.46s/it] 10%|█         | 2/20 [00:31<04:54, 16.38s/it] 15%|█▌        | 3/20 [00:45<04:27, 15.73s/it] 20%|██        | 4/20 [00:58<04:00, 15.03s/it]